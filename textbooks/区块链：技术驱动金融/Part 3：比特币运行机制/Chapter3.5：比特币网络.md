<!--
 * @Author: ZhXZhao
 * @Date: 2020-02-09 20:55:44
 * @LastEditors  : ZhXZhao
 * @LastEditTime : 2020-02-09 21:30:29
 * @Description: 
 -->
# 比特币网络

----

- [比特币网络](#%e6%af%94%e7%89%b9%e5%b8%81%e7%bd%91%e7%bb%9c)
  - [发起交易的过程](#%e5%8f%91%e8%b5%b7%e4%ba%a4%e6%98%93%e7%9a%84%e8%bf%87%e7%a8%8b)
  - [核验过程](#%e6%a0%b8%e9%aa%8c%e8%bf%87%e7%a8%8b)
  - [泛洪算法](#%e6%b3%9b%e6%b4%aa%e7%ae%97%e6%b3%95)
  - [完全有效节点](#%e5%ae%8c%e5%85%a8%e6%9c%89%e6%95%88%e8%8a%82%e7%82%b9)
  - [轻量节点](#%e8%bd%bb%e9%87%8f%e8%8a%82%e7%82%b9)

比特币网络是点对点网络，所有节点都是平等的，运行在TCP网络上，有一个随意的拓扑结构。
## 发起交易的过程
当有人发起一个交易时，会通过“泛洪（flooding）”算法让整个网络都知道。
具体为：将交易告知与其相连的节点，这些节点进行一系列核验，决定是否接受并转播这笔交易，当节点接受一个交易信息后，会把交易放入一个交易池（交易池中的交易没有被打包进区块链），若节点的交易池中已存在接受道德交易，则不会转播，这样可以使得“泛洪”自动停止。
## 核验过程
1. 交易验证。验证交易在区块链中是有效的，节点会针对每个前序交易的输出运行核验脚本，确保脚本的返回值都为真。
2. 检查是否有双重支付。
3. 检查交易信息是否受到过。
4. 检查是否在白名单上。

区块的传播与交易的传播过程类似。核验一个区块除了需要确认区块头部里的哈希值是在可接受范围，还需确认区块里的每笔交易。

## 泛洪算法
泛洪算法很简单，但效率很低，较大的区块需要很长的时间才能到达最远的节点。

## 完全有效节点
完全有效节点必须永久在线，以接受所有的交易数据。还要把完整的共识区块链都存储下来，还须维护在交易中产生的、未被消耗掉的比特币的完整列表。

## 轻量节点
也叫简单付款验证（SPV）客户端。这些节点不会存储整个比特币区块链，它们只存储所关心的、需要进行核验的部分交易。
