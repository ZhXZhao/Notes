<!--
 * @Author: ZhXZhao
 * @Date: 2020-02-13 17:31:50
 * @LastEditors  : ZhXZhao
 * @LastEditTime : 2020-02-13 20:57:26
 * @Description: 
 -->
# 反ASIC解谜算法

---

- [反ASIC解谜算法](#%e5%8f%8dasic%e8%a7%a3%e8%b0%9c%e7%ae%97%e6%b3%95)
  - [刚性内存解谜](#%e5%88%9a%e6%80%a7%e5%86%85%e5%ad%98%e8%a7%a3%e8%b0%9c)
    - [Scrypt](#scrypt)
      - [杜鹃鸟周期算法](#%e6%9d%9c%e9%b9%83%e9%b8%9f%e5%91%a8%e6%9c%9f%e7%ae%97%e6%b3%95)
  - [关于反ASIC的争论](#%e5%85%b3%e4%ba%8e%e5%8f%8dasic%e7%9a%84%e4%ba%89%e8%ae%ba)


人们希望比特币网络中的每个用户都可以进行挖矿，而不希望整个挖矿过程被拥有强大ASIC的职业矿工所控制。

## 刚性内存解谜

大多数被设计成反ASIC的解谜程序中，最普遍被应用的叫做刚性内存解谜（memory-hard puzzles）——解谜需要大量的内存来计算，而不是靠大量的CPU时间。类似的是内存限制解谜（memory-bound puzzles），花在读取内存上的时间，占据了这种程序大部分的计算时间。

### Scrypt

目前最受欢迎的刚性内存解谜是Scrypt。我们期望，一个有着定制化设备的用户不能够比使用一般电脑或者服务器的用户更快地计算密码的函数值。
Scrypt有两个步骤：
1. 用随机数据填充随机存取存储器（RAM）里面的缓存空间。
2. 从这块内存区域里虚拟随机地读取（或更新）数据，同时要求整个缓存都在RAM里。

Scrypt伪代码：
```python{class=line-numbers}
def scrypt(N, seed):
    V = [0] * N    //初始化N长度的缓存区域

    //往这个区域里充满虚拟随机数
    V[0] = seed
    for i = 1 to N:
        V[i] = SHA-256(V[i-1])

        //然后从这个区域里虚拟随意地读取
        X = SHA-256(V[N-1])
        for j = 1 to N:
            j = X % N    //根据X，选择一个随机的索引
            X = SHA-256(X ^ V[j])    根据X的索引来更新这个X
    return X
```

不使用缓存计算整个函数需要N*N/2=$N^2/2$个SHA-256计算，如果使用缓存的话，只需要进行2N次运算。缓存的使用将Scrypt的时间复杂度从O($N^2$)转换成O(n)。这样一来，只要简单地选一个足够大的N值使得O($N^2$)的计算变得足够慢，以此确保使用内存是更快的选择。

但Scrypt的校验成本很大。需要用与计算所用的同样大小的内存来做校验。

#### 杜鹃鸟周期算法

杜鹃鸟周期算法，是从杜鹃鸟哈希表所衍生的一张图中寻找周期的难度而设定的，除了建立起一个很大的哈希表之外，没有其他已知的方法来计算这个周期，结果却可以通过发现一个周期（相对小的）来简单地验证。
但这个算法无法在数学上证明：如果它不用内存的话就不能被有效地计算，所以杜鹃鸟周期算法还没有被任何加密数字货币所采用。

## 关于反ASIC的争论

一方面说，反ASIC可以使得全网的节点都平等地挖矿。
但还有一种意见认为，高度反ASIC的算法可能会暂时租用巨大算力，发动51%攻击，摧毁整个数字货币而几乎不承受任何损失。
