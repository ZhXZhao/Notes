<!--
 * @Author: ZhXZhao
 * @Date: 2020-02-22 22:24:37
 * @LastEditors: ZhXZhao
 * @LastEditTime: 2020-02-22 22:47:46
 * @Description: 
 -->

# 构建区块

---


- [构建区块](#%e6%9e%84%e5%bb%ba%e5%8c%ba%e5%9d%97)
  - [工作量证明算法](#%e5%b7%a5%e4%bd%9c%e9%87%8f%e8%af%81%e6%98%8e%e7%ae%97%e6%b3%95)
  - [难度表示](#%e9%9a%be%e5%ba%a6%e8%a1%a8%e7%a4%ba)
  - [难度目标与难度调整](#%e9%9a%be%e5%ba%a6%e7%9b%ae%e6%a0%87%e4%b8%8e%e9%9a%be%e5%ba%a6%e8%b0%83%e6%95%b4)

构建了一个候选区块后，通过挖矿，即求解工作量证明算法来使得该候选区块有效。比特币中挖矿使用的是SHA256哈希函数。

## 工作量证明算法

哈希函数的输入值长度是任意的，且输出的长度是固定的而且绝不雷同，可将其视为输入的数字指纹。对于特定输入，使用相同的哈希函数每次的输出都是一样的。

比特币的工作量证明为矿工计算构建的候选区块头的哈希值，检查是否小于当前的目标值，若不小于，则修改nonce（通常是加1），然后再试一次。直到小于当前目标值则视为挖矿成功，该矿工获得记账权力。

## 难度表示

难度表示值被表示为指数/系数格式，前两位十六进制数字为指数，接下来六位数字为系数。
计算难度目标的公式：
$$ target = coefficient * 2^{8 * (exponent – 3)} $$

## 难度目标与难度调整

比特币的区块平均每10分钟生成一个。当比特币网络中的算力发生改变时，对应的难度就需要进行调整，以保证比特币区块平均每10分钟生成一个。
每产生2,016个区块，所有节点都会调整一次难度。
调整公式为：
$$ New \ Difficulty = Old \ Difficulty * (Actual \ Time \ of \ Last \ 2016 \ Blocks \ / \ 20160 \ minutes) $$

为了防止难度的变化过快，每个周期的调整幅度必须小于一个因子（值为4）。如果要调整的幅度大于4倍，则按4倍调整。


