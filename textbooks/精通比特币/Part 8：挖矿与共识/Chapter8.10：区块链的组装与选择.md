<!--
 * @Author: ZhXZhao
 * @Date: 2020-02-22 22:56:54
 * @LastEditors: ZhXZhao
 * @LastEditTime: 2020-02-23 21:47:03
 * @Description: 
 -->

# 区块链的组装与选择

---


- [区块链的组装与选择](#%e5%8c%ba%e5%9d%97%e9%93%be%e7%9a%84%e7%bb%84%e8%a3%85%e4%b8%8e%e9%80%89%e6%8b%a9)
  - [区块链分叉](#%e5%8c%ba%e5%9d%97%e9%93%be%e5%88%86%e5%8f%89)

比特币去中心化的共识机制的最后一步是将区块追加至有最大工作量证明的链中。

节点维护三种区块：
1. 连接到主链上的。
2. 从主链上产生分支的。
3. 在已知链中没有找到父区块的。

主链上会有一些分支，分支中的区块与主链上的区块互为兄弟区块，这些区块是有效的，但并不在主链上。保留这些分支的目的是，若在某个时刻它们中的一个延长了并在难度上超过了主链，后续区块将会引用它们。

## 区块链分叉

因为区块链是去中心化数据结构，不同副本之间不能总是保持一致。解决办法是，每个节点总是选择并尝试延长代表累积了最大工作量证明的区块链。

分叉发生在两名矿工在较短时间内，各自都算得了工作量证明解的时候。

当两个有效区块在较短时间内被挖出并广播时，网络中的节点留下先收到的区块，忽略后到来的区块，这时区块链就产生了分叉，随后双方各自在各自的区块链上挖矿，直到有一方先挖出了下一个候选区块，并广播，此时这一方的区块链长度大于另一方的，那么另一方的节点就会改变主链，将较长的链作为主链，这也叫做**链的重新共识**。

比特币将区块间隔设计为10分钟，是在更快速的交易确认和更低的分叉概率间作出的妥协。
