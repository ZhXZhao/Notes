<!--
 * @Author: ZhXZhao
 * @Date: 2020-02-23 21:44:29
 * @LastEditors: ZhXZhao
 * @LastEditTime: 2020-02-23 22:24:03
 * @Description: 
 -->

# 挖矿和算力竞赛

---

- [挖矿和算力竞赛](#%e6%8c%96%e7%9f%bf%e5%92%8c%e7%ae%97%e5%8a%9b%e7%ab%9e%e8%b5%9b)
  - [随机值升位方案](#%e9%9a%8f%e6%9c%ba%e5%80%bc%e5%8d%87%e4%bd%8d%e6%96%b9%e6%a1%88)
  - [矿池](#%e7%9f%bf%e6%b1%a0)
    - [托管矿池](#%e6%89%98%e7%ae%a1%e7%9f%bf%e6%b1%a0)
    - [P2P矿池](#p2p%e7%9f%bf%e6%b1%a0)


2010年到2011年，矿工从使用CPU挖矿升级到使用GPU挖矿，进而使用FPGA（现场可编程门列）。2013年，引入ASIC挖矿，引起了算力的一次巨大飞跃。

## 随机值升位方案

在比特币早期，矿工可以通过遍历随机数（Nonce）来获得符合要求的哈希值，以此挖出一个块。

在难度增长后，矿工经常在遍历了40亿个可能的随机值都没有找到符合要求的哈希值，这时矿工会将时间戳延后一点，再重新遍历随机值，但若将时间戳延后过长，会导致区块变为无效。因此有一种新的方案：将coinbase交易作为额外的随机值来源，因为coinbase脚本可以存储2-100个字节的数据。coinbase包含在merkle树种，coinbase的改变会导致merkle树根的变化。

## 矿池

个体矿工无法与商业矿场竞争，因此矿工们合作组成矿池，汇集参与者门的算力并分享奖励。

**矿池如何衡量矿工的贡献？**
矿池会设置一个相较于比特币网络挖矿难度低很多的一个难度，如果矿池中有矿工发现了矿池难度的区块，则记录该矿工的贡献。

### 托管矿池

大部分矿池时托管的，意思是有一个公司或个人经营一个矿池服务器，矿池服务器的所有者叫矿池管理员，同时他从矿工的收入中收取一个百分比费用。

矿池服务器运行专业软件以及协调池中矿工们活动的矿池采矿协议。矿池服务器会替代矿池中的矿工验证区块和交易，减缓他们的负担。

矿工连接到矿池服务器使用一个采矿协议比如Stratum (STM)或者 GetBlockTemplate (GBT)。STM和GBT协议都创建包含候选区块头模板的区块模板。这个模板是矿池服务器聚集交易，添加coinbase交易，计算merkle树根并连接父区块hash创建的。然后将这个模板发送给矿池中的矿工，矿工在此上挖矿。

### P2P矿池

托管矿池存在着中心化单点故障问题，因此出现了P2Pool。

矿工们会在一个类似区块链的，叫做份额链的上挖矿，份额连是一个难度低于比特币区块链的区块链系统，区块记录着工作的矿工的份额，一旦找到了一个达到比特币网络难度的目标时，会广播到比特币网络，所得的奖励会按照份额比例分给份额链上取得份额的池中矿工。

但P2Pool采矿要求矿工能够支持一个比特币的完整节点和P2Pool节点软件。
